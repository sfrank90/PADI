<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>Mister Spex: Buffer.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="LogoDoxy.jpg"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Mister Spex
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">The project Mister Spex is a funny tool to capture images and display them with overlays such as glasses or big red lips over the normal human face. All images can be saved or recorded. Within this software you have three different mode to get the images (LiveView via webcam, Static image and a playback of a recorded video).</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Buffer.h</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#ifndef BUFFER_H</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define BUFFER_H</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// Qt</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;QMutex&gt;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;QQueue&gt;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;QSemaphore&gt;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;QByteArray&gt;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div>
<div class="line"><a name="l00014"></a><span class="lineno"><a class="code" href="classBuffer.html">   14</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; <span class="keyword">class </span><a class="code" href="classBuffer.html" title="Buffer template class. ">Buffer</a></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;{</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;        <a class="code" href="classBuffer.html#adbe561d1c65425669c8e75ba393b8723" title="Template function to initialize a new buffer of type T with a specific size. Compareable to a constru...">Buffer</a>(<span class="keywordtype">int</span> <a class="code" href="classBuffer.html#a47bf87cf0f9c3e459c6e9204057dd4f7" title="Template function to get actual buffer size. ">size</a>);</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classBuffer.html#a7466e67129fefdbb7917520f4084635f" title="Template function add data of type T to the buffer. Data can be dropped if buffer is full...">add</a>(<span class="keyword">const</span> T&amp; data, <span class="keywordtype">bool</span> dropIfFull=<span class="keyword">false</span>);</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;        T <span class="keyword">get</span>();</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="classBuffer.html#a47bf87cf0f9c3e459c6e9204057dd4f7" title="Template function to get actual buffer size. ">size</a>();</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="classBuffer.html#a7825d879c854b6c8b11e6d14e6f823c5" title="Template function to get max buffer size. ">maxSize</a>();</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="classBuffer.html#aacaf1177f6703f9309301febb0f50684" title="Template function to clear the actual buffer. ">clear</a>();</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="classBuffer.html#aafaaee379bcc00add370291d7f640715" title="Template function check if buffer is full. ">isFull</a>();</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="classBuffer.html#a628f1c356eaabb3948304dd8cdbbd208" title="Template function check if buffer is empty. ">isEmpty</a>();</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="keyword">private</span>:</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div>
<div class="line"><a name="l00031"></a><span class="lineno"><a class="code" href="classBuffer.html#a13ab019c0a62f5d8195455e5166ebe08">   31</a></span>&#160;        QMutex <a class="code" href="classBuffer.html#a13ab019c0a62f5d8195455e5166ebe08" title="QMutex. ">queueProtect</a>;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div>
<div class="line"><a name="l00036"></a><span class="lineno"><a class="code" href="classBuffer.html#ae0ae93881b36b26e3c85dff0b879930f">   36</a></span>&#160;        QQueue&lt;T&gt; <a class="code" href="classBuffer.html#ae0ae93881b36b26e3c85dff0b879930f" title="QQueue. ">queue</a>;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div>
<div class="line"><a name="l00041"></a><span class="lineno"><a class="code" href="classBuffer.html#aff8ee57de375161207f3214b1e4db2c3">   41</a></span>&#160;        QSemaphore *<a class="code" href="classBuffer.html#aff8ee57de375161207f3214b1e4db2c3" title="QSemaphore - free Slots. ">freeSlots</a>;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div>
<div class="line"><a name="l00046"></a><span class="lineno"><a class="code" href="classBuffer.html#ace3ee207ac4bbec4f23845dc2940a52e">   46</a></span>&#160;        QSemaphore *<a class="code" href="classBuffer.html#ace3ee207ac4bbec4f23845dc2940a52e" title="QSemaphore - used Slots. ">usedSlots</a>;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div>
<div class="line"><a name="l00051"></a><span class="lineno"><a class="code" href="classBuffer.html#aeea5ef0dc5efbfcaf1be2861623960c6">   51</a></span>&#160;        QSemaphore *<a class="code" href="classBuffer.html#aeea5ef0dc5efbfcaf1be2861623960c6" title="QSemaphore - clear add Buffer. ">clearBuffer_add</a>;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div>
<div class="line"><a name="l00056"></a><span class="lineno"><a class="code" href="classBuffer.html#a195f8ce4f909a3cddd7ef41e8e9129e4">   56</a></span>&#160;        QSemaphore *<a class="code" href="classBuffer.html#a195f8ce4f909a3cddd7ef41e8e9129e4" title="QSemaphore - clear get Buffer. ">clearBuffer_get</a>;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div>
<div class="line"><a name="l00061"></a><span class="lineno"><a class="code" href="classBuffer.html#a72b54b7499ee8fa096e2a5749ddf1e3f">   61</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="classBuffer.html#a72b54b7499ee8fa096e2a5749ddf1e3f" title="Buffer size. ">bufferSize</a>;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;};</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div>
<div class="line"><a name="l00068"></a><span class="lineno"><a class="code" href="classBuffer.html#adbe561d1c65425669c8e75ba393b8723">   68</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; <a class="code" href="classBuffer.html#adbe561d1c65425669c8e75ba393b8723" title="Template function to initialize a new buffer of type T with a specific size. Compareable to a constru...">Buffer&lt;T&gt;::Buffer</a>(<span class="keywordtype">int</span> size)</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;{</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="comment">// Save buffer size</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    bufferSize = size;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="comment">// Create semaphores</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    freeSlots = <span class="keyword">new</span> QSemaphore(bufferSize);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    usedSlots = <span class="keyword">new</span> QSemaphore(0);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    clearBuffer_add = <span class="keyword">new</span> QSemaphore(1);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    clearBuffer_get = <span class="keyword">new</span> QSemaphore(1);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;}</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="code" href="classBuffer.html#a7466e67129fefdbb7917520f4084635f">   84</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">void</span> <a class="code" href="classBuffer.html#a7466e67129fefdbb7917520f4084635f" title="Template function add data of type T to the buffer. Data can be dropped if buffer is full...">Buffer&lt;T&gt;::add</a>(<span class="keyword">const</span> T&amp; data, <span class="keywordtype">bool</span> dropIfFull)</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;{</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">// Acquire semaphore</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    clearBuffer_add-&gt;acquire();</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="comment">// If dropping is enabled, do not block if buffer is full</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordflow">if</span>(dropIfFull)</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <span class="comment">// Try and acquire semaphore to add item</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keywordflow">if</span>(freeSlots-&gt;tryAcquire())</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            <span class="comment">// Add item to queue</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            queueProtect.lock();</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            queue.enqueue(data);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            queueProtect.unlock();</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            <span class="comment">// Release semaphore</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            usedSlots-&gt;release();</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        }</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    }</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="comment">// If buffer is full, wait on semaphore</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="comment">// Acquire semaphore</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        freeSlots-&gt;acquire();</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="comment">// Add item to queue</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        queueProtect.lock();</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        queue.enqueue(data);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        queueProtect.unlock();</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="comment">// Release semaphore</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        usedSlots-&gt;release();</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    }</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="comment">// Release semaphore</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    clearBuffer_add-&gt;release();</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;}</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div>
<div class="line"><a name="l00122"></a><span class="lineno"><a class="code" href="classBuffer.html#a80aefbb96aa9d1e4117f9b76e0ee0a06">  122</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; T <a class="code" href="classBuffer.html#a80aefbb96aa9d1e4117f9b76e0ee0a06" title="Template function get data of type T from the buffer. ">Buffer&lt;T&gt;::get</a>()</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;{</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="comment">// Local variable(s)</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    T data;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="comment">// Acquire semaphores</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    clearBuffer_get-&gt;acquire();</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    usedSlots-&gt;acquire();</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="comment">// Take item from queue</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    queueProtect.lock();</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    data=queue.dequeue();</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    queueProtect.unlock();</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="comment">// Release semaphores</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    freeSlots-&gt;release();</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    clearBuffer_get-&gt;release();</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="comment">// Return item to caller</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordflow">return</span> data;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;}</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div>
<div class="line"><a name="l00144"></a><span class="lineno"><a class="code" href="classBuffer.html#aacaf1177f6703f9309301febb0f50684">  144</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">bool</span> <a class="code" href="classBuffer.html#aacaf1177f6703f9309301febb0f50684" title="Template function to clear the actual buffer. ">Buffer&lt;T&gt;::clear</a>()</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;{</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="comment">// Check if buffer contains items</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordflow">if</span>(queue.size()&gt;0)</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="comment">// Stop adding items to buffer (will return false if an item is currently being added to the buffer)</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="keywordflow">if</span>(clearBuffer_add-&gt;tryAcquire())</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            <span class="comment">// Stop taking items from buffer (will return false if an item is currently being taken from the buffer)</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            <span class="keywordflow">if</span>(clearBuffer_get-&gt;tryAcquire())</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                <span class="comment">// Release all remaining slots in queue</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                freeSlots-&gt;release(queue.size());</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                <span class="comment">// Acquire all queue slots</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                freeSlots-&gt;acquire(bufferSize);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                <span class="comment">// Reset usedSlots to zero</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                usedSlots-&gt;acquire(queue.size());</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                <span class="comment">// Clear buffer</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                queue.clear();</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                <span class="comment">// Release all slots</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                freeSlots-&gt;release(bufferSize);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                <span class="comment">// Allow get method to resume</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                clearBuffer_get-&gt;release();</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            <span class="comment">// Allow add method to resume</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            clearBuffer_add-&gt;release();</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        }</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    }</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;}</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div>
<div class="line"><a name="l00185"></a><span class="lineno"><a class="code" href="classBuffer.html#a47bf87cf0f9c3e459c6e9204057dd4f7">  185</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">int</span> <a class="code" href="classBuffer.html#a47bf87cf0f9c3e459c6e9204057dd4f7" title="Template function to get actual buffer size. ">Buffer&lt;T&gt;::size</a>()</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;{</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordflow">return</span> queue.size();</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;}</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div>
<div class="line"><a name="l00194"></a><span class="lineno"><a class="code" href="classBuffer.html#a7825d879c854b6c8b11e6d14e6f823c5">  194</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">int</span> <a class="code" href="classBuffer.html#a7825d879c854b6c8b11e6d14e6f823c5" title="Template function to get max buffer size. ">Buffer&lt;T&gt;::maxSize</a>()</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;{</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordflow">return</span> bufferSize;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;}</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div>
<div class="line"><a name="l00203"></a><span class="lineno"><a class="code" href="classBuffer.html#aafaaee379bcc00add370291d7f640715">  203</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">bool</span> <a class="code" href="classBuffer.html#aafaaee379bcc00add370291d7f640715" title="Template function check if buffer is full. ">Buffer&lt;T&gt;::isFull</a>()</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;{</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordflow">return</span> queue.size()==bufferSize;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;}</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div>
<div class="line"><a name="l00212"></a><span class="lineno"><a class="code" href="classBuffer.html#a628f1c356eaabb3948304dd8cdbbd208">  212</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">bool</span> <a class="code" href="classBuffer.html#a628f1c356eaabb3948304dd8cdbbd208" title="Template function check if buffer is empty. ">Buffer&lt;T&gt;::isEmpty</a>()</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;{</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordflow">return</span> queue.size()==0;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;}</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="preprocessor">#endif // BUFFER_H</span></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Jan 22 2014 11:38:59 for Mister Spex by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.4
</small></address>
</body>
</html>
